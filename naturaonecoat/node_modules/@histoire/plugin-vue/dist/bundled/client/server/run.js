import { createApp, h } from "vue";
import Story from "./Story.js";
import Variant from "./Variant.js";
async function run({ file, storyData, el }) {
  const { default: Comp } = await import(
    /* @vite-ignore */
    file.moduleId
  );
  const app = createApp({
    provide: {
      addStory(data) {
        storyData.push(data);
      }
    },
    render() {
      return h(Comp, {
        ref: "comp",
        data: file
      });
    }
  });
  app.component("Story", Story);
  app.component("Variant", Variant);
  app.mount(el);
  if (Comp.doc) {
    const el2 = document.createElement("div");
    el2.innerHTML = Comp.doc;
    const text = el2.textContent;
    storyData.forEach((s) => {
      s.docsText = text;
    });
  }
  app.unmount();
}
export { run };
